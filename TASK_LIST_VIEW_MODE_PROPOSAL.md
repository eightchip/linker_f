# タスクリスト表示モード提案書

## 現状の問題点

現在のタスクリストビューは、1つのタスクカードに以下の情報が表示されるため、カードの高さが大きくなり、画面に5件程度しか表示できない問題があります：

- タスクタイトル（カスタマイズ可能なフォントサイズ）
- 依頼先/メモ（展開時は完全表示）
- 説明文（展開時は完全表示）
- タグ（複数表示可能）
- 関連リンク（展開時のみ）
- 期限日バッジ
- ステータス、優先度、サブタスクバッジなど

詳細を確認するためにタスクを展開すると、さらに表示件数が減ってしまいます。

## 提案：2つの表示モード

ユーザーが用途に応じて表示モードを選択できるようにし、一覧性と詳細性のバランスを取れるようにします。

### モード1: コンパクトモード（一覧性重視）

**目的**: 可能な限り多くのタスクを一覧で確認したい場合

**表示内容**:
- ✅ タスクタイトル（1行、フォントサイズは標準の0.9倍程度）
- ✅ 期限日バッジ（小さめ）
- ✅ ステータスバッジ（テキストまたは色のみ）
- ✅ 優先度インジケーター（小さめのアイコン）
- ✅ ピン留めアイコン
- ❌ 依頼先/メモ（非表示、ホバー時ツールチップで表示）
- ❌ 説明文（非表示、ホバー時ツールチップで表示）
- ❌ タグ（非表示、または1行のみ）
- ❌ 関連リンク（非表示）
- ❌ 詳細展開ボタン（非表示）

**レイアウト**:
- カードのパディングを最小限（現在の0.5倍程度）
- カード間のスペースを最小限
- 1行表示を基本とし、最大高さを制限
- `dense: true` を使用

**想定表示件数**: 10-15件/画面（現在の2-3倍）

---

### モード2: 標準モード（現在の実装）

**目的**: バランスの取れた表示（デフォルト）

**表示内容**: 現在の実装をそのまま維持

**想定表示件数**: 5-8件/画面

**注意**: 詳細情報が必要な場合は、標準モードで詳細トグルボタンを使用して展開できます。

---

## UI実装案

### 表示モード切り替えボタン

タスク管理画面のツールバー（検索バーの近く、またはフィルター設定の近く）に、以下のような切り替えボタンを追加：

```
[コンパクト] [標準]
```

または、アイコンボタン：

```
[☰ コンパクト] [≡ 標準]
```

または、トグルボタン形式：

```
[コンパクト ⇄ 標準]
```

### 設定の永続化

選択した表示モードはユーザー設定として保存し、次回起動時も維持されるようにします。

実装方法:
- Hiveで `listViewMode` を保存（`'compact'`, `'standard'`）
- または既存の設定保存機構を利用

---

## 実装の詳細設計

### 1. 状態管理

```dart
enum ListViewMode {
  compact,   // コンパクトモード
  standard,  // 標準モード（現在の実装）
}
```

### 2. 表示モードによる条件分岐

`_buildImprovedTaskListTile` メソッド内で、選択された表示モードに応じて表示内容とスタイルを変更：

```dart
Widget _buildImprovedTaskListTile(TaskItem task, bool isSelected, {int? reorderIndex}) {
  final listViewMode = _listViewMode; // 状態変数
  
  if (listViewMode == ListViewMode.compact) {
    return _buildCompactTaskTile(task, isSelected, reorderIndex: reorderIndex);
  } else {
    // 標準モード: 現在の実装をそのまま使用
    return _buildStandardTaskTile(task, isSelected, reorderIndex: reorderIndex);
  }
}
```

### 3. 各モード用のビルダーメソッド

- `_buildCompactTaskTile`: 最小限の情報のみ表示（新規実装）
- `_buildStandardTaskTile`: 現在の `_buildImprovedTaskListTile` の内容をそのまま使用

---

## メリット

1. **一覧性の向上**: コンパクトモードで多くのタスクを一度に確認可能
2. **柔軟性**: ユーザーが用途に応じて最適な表示モードを選択可能
3. **段階的移行**: 標準モードを維持することで既存ユーザーへの影響を最小化
4. **グリッドビューとの棲み分け**: リストビューは詳細確認、グリッドビューは視覚的な一覧確認として使い分け可能

---

## 検討事項

1. **デフォルトモード**: 標準モードをデフォルトとし、既存ユーザーの体験を維持
2. **グリッドビューとの関係**: リストビューとグリッドビューの切り替えは既存のまま維持し、さらにリストビュー内で表示モードを選択可能にする
3. **パフォーマンス**: コンパクトモードでは表示するウィジェットが減るため、スクロールパフォーマンスが向上する可能性
4. **アクセシビリティ**: コンパクトモードでも重要な情報（期限、ステータス）は確実に表示されるようにする

---

## 次のステップ

この提案が承認された場合：

1. `ListViewMode` enumの定義
2. 表示モード切り替えUIの追加
3. 各モード用のビルダーメソッドの実装
4. 設定の永続化
5. テストと調整

